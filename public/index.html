<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –æ–±–º–µ–Ω</title>
  <style>
    body { font-family: Arial; max-width: 600px; margin: 2rem auto; padding: 0 1rem; }
    .card { background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
    input { width: 100%; padding: 0.8rem; margin: 1rem 0; border: 2px solid #ddd; border-radius: 5px; }
    button { background: #007bff; color: white; border: none; padding: 1rem 2rem; border-radius: 5px; cursor: pointer; }
    button:hover { background: #0056b3; }
    .status { margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-radius: 5px; }
    .error { color: #dc3545; margin: 1rem 0; }
  </style>
</head>
<body>
  <div class="card">
    <h1>üé∂ –ï–±–∞—à—Ç–µ —Ö–æ—Ä—è–≥—É</h1>
    
    <form action="/submit" method="POST">
      <input 
        type="text" 
        name="song" 
        placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Å–Ω–∏"
        required
      >
      <button type="submit">–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å</button>
    </form>

    <div class="status" id="status">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç—É—Å–∞...</div>
    <div id="error"></div>
  </div>

  <script>
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
    function updateStatus() {
      fetch('/status')
        .then(res => res.json())
        .then(data => {
          document.getElementById('status').innerHTML = `
            –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: ${data.count}/10
            ${data.ready ? '<p>üéâ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! <a href="/result">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</a></p>' : ''}
          `;
        });
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
    const urlParams = new URLSearchParams(window.location.search);
    const error = urlParams.get('error');
    if (error) {
      document.getElementById('error').innerHTML = `
        <div class="error">‚ö†Ô∏è ${error}</div>
      `;
    }

    // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
    setInterval(updateStatus, 3000);
    updateStatus();
  </script>
</body>
</html>